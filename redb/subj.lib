#!/bin/bash

printf "Running Subdomain takeover on $DOMAIN" | notify --silent -p discord -id "crawl5"
rm -rf 3eb88debcb01759eccf65ec2b799b340
git clone https://gist.github.com/3eb88debcb01759eccf65ec2b799b340.git
mkdir subdomains && cd 3eb88debcb01759eccf65ec2b799b340 && cp redbull-bug-bounty-scope-rb-only.txt ../subdomains/ && cd ..
mkdir subdomain_takeover && cd subdomain_takeover
subjack -w ../subdomains/redbull-bug-bounty-scope-rb-only.txt -o results.txt
nuclei -l ../subdomains/redbull-bug-bounty-scope-rb-only.txt -silent -t ${HOME}/nuclei-templates/http/takeovers/ -o nuclei_takeover.txt
cat ../subdomains/redbull-bug-bounty-scope-rb-only.txt | httpx -status-code --path .s3.amazonaws.com | tee s3_takeover.txt
subjack -w s3_takeovers.txt -t 100 -timeout 30 -o s3_subjack_results.txt -ssl

cat results.txt nuclei_takeover.txt s3_subjack_results.txt | notify --silent -p discord -id "crawl5"
cd ..

printf "Subdomain takeover work is completed" | notify --silent -p discord -id "crawl5"
